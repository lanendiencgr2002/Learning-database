# Python办公自动化指南

## 环境准备

首先需要安装以下Python库:

```bash
pip install openpyxl  # 处理Excel
pip install python-docx  # 处理Word 
pip install PyPDF2  # 处理PDF
pip install pandas  # 数据处理
```

## Excel自动化

### 批量合并Excel文件

```python
import pandas as pd
from pathlib import Path

def merge_excel_files(folder_path):
    folder = Path(folder_path)
    all_data = []
    
    for excel_file in folder.glob("*.xlsx"):
        print(f"正在处理：{excel_file.name}")
        df = pd.read_excel(excel_file)
        df['来源文件'] = excel_file.name
        all_data.append(df)
    
    merged_data = pd.concat(all_data, ignore_index=True)
    merged_data.to_excel("合并汇总.xlsx", index=False)
    print("搞定！文件都合并好了~")

# 使用示例
merge_excel_files("销售数据")
```

### 自动生成数据报表

```python
from openpyxl import Workbook
from openpyxl.styles import Font, PatternFill

def create_sales_report(data):
    wb = Workbook()
    ws = wb.active
    ws.title = "销售报表"
    
    # 设置表头
    headers = ["产品名称", "销量", "单价", "总金额"]
    for col, header in enumerate(headers, 1):
        cell = ws.cell(row=1, column=col)
        cell.value = header
        cell.font = Font(bold=True, color="FFFFFF")
        cell.fill = PatternFill("solid", fgColor="44546A")
    
    # 填充数据
    for row, record in enumerate(data, 2):
        for col, value in enumerate(record, 1):
            cell = ws.cell(row=row, column=col)
            cell.value = value
            if row % 2 == 0:
                cell.fill = PatternFill("solid", fgColor="F2F2F2")
    
    # 自动调整列宽
    for col in ws.columns:
        max_length = max(len(str(cell.value)) for cell in col)
        ws.column_dimensions[col[0].column_letter].width = max_length + 2
    
    wb.save("精美销售报表.xlsx")
    print("报表生成完毕，快去看看吧！")

# 测试数据
sales_data = [
    ["苹果手机", 120, 6999, "=B2*C2"],
    ["平板电脑", 85, 3999, "=B3*C3"],
    ["智能手表", 200, 1999, "=B4*C4"]
]

create_sales_report(sales_data)
```

## Word自动化

### 批量生成工作周报

```python
from docx import Document
from datetime import datetime, timedelta

def generate_weekly_report(name, department, tasks):
    doc = Document()
    
    current_date = datetime.now()
    start_date = current_date - timedelta(days=current_date.weekday())
    end_date = start_date + timedelta(days=4)
    
    title = f"{name}的工作周报 ({start_date.strftime('%m.%d')}-{end_date.strftime('%m.%d')})"
    doc.add_heading(title, 0)
    
    doc.add_paragraph(f"部门：{department}")
    doc.add_paragraph(f"姓名：{name}")
    
    doc.add_heading("本周工作内容：", level=1)
    for idx, task in enumerate(tasks, 1):
        doc.add_paragraph(f"{idx}. {task}", style='List Number')
    
    doc.add_heading("下周工作计划：", level=1)
    doc.add_paragraph("1. 继续跟进本周未完成事项")
    doc.add_paragraph("2. 准备月度总结报告")
    
    filename = f"周报_{name}_{current_date.strftime('%Y%m%d')}.docx"
    doc.save(filename)
    print(f"周报已生成：{filename}")

# 使用示例
tasks = [
    "完成产品需求文档编写",
    "召开团队周会，分配任务",
    "处理客户反馈的bug，并更新系统",
    "参加产品培训会议"
]

generate_weekly_report("张小明", "技术部", tasks)
```

## PDF处理

### PDF合并工具

```python
from PyPDF2 import PdfMerger
from pathlib import Path

def merge_pdfs(folder_path, output_name="合并文件.pdf"):
    folder = Path(folder_path)
    merger = PdfMerger()
    
    pdf_files = sorted(folder.glob("*.pdf"))
    
    if not pdf_files:
        print("没找到PDF文件哦~")
        return
    
    print("开始合并PDF...")
    for pdf in pdf_files:
        print(f"正在添加：{pdf.name}")
        merger.append(str(pdf))
    
    merger.write(output_name)
    merger.close()
    print(f"完成！已保存为：{output_name}")

# 使用示例
merge_pdfs("合同文件")
```

## 综合自动化工具

```python
from pathlib import Path
import shutil

def office_automation(work_dir):
    work_path = Path(work_dir)
    
    result_folder = work_path / "处理结果"
    result_folder.mkdir(exist_ok=True)
    
    print("🚀 开始自动化处理...")
    
    # 处理Excel文件
    excel_files = list(work_path.glob("*.xlsx"))
    if excel_files:
        print("\n📊 处理Excel文件...")
        merge_excel_files(work_dir)
        shutil.move("合并汇总.xlsx", result_folder)
    
    # 处理PDF文件
    pdf_files = list(work_path.glob("*.pdf"))
    if pdf_files:
        print("\n📄 处理PDF文件...")
        merge_pdfs(work_dir, str(result_folder / "合并文档.pdf"))
    
    print("\n✨ 处理完成！请查看'处理结果'文件夹")

# 一键启动
office_automation("工作文件夹")
```

## 使用注意事项

1. 处理大文件前最好先备份
2. Excel公式要用字符串形式写，比如"=SUM(A1:A10)"
3. 合并PDF时注意内存占用
4. 文件名最好不要用中文，避免编码问题