# Python图片处理自动化指南

## 环境准备

首先安装必要的Python库:

```bash
pip install Pillow
pip install pathlib
```

> 温馨提示：用 pathlib 处理文件路径比传统的 os 模块优雅多了，用了就知道！

## 批量重命名

### 图片批量重命名工具

```python
from pathlib import Path

def batch_rename(folder_path, prefix="IMG_"):
    # 创建目录对象
    folder = Path(folder_path)
    
    # 遍历所有图片文件
    for idx, img_path in enumerate(folder.glob("*.jpg")):
        # 新名字：前缀 + 序号，例如：IMG_001.jpg
        new_name = f"{prefix}{idx:03d}{img_path.suffix}"
        # 重命名
        img_path.rename(folder / new_name)
        print(f"已重命名: {img_path.name} -> {new_name}")

# 使用示例
batch_rename("我的照片集")
```

## 图片尺寸处理

### 批量调整图片尺寸

```python
from PIL import Image
from pathlib import Path

def resize_images(folder_path, max_size=800):
    folder = Path(folder_path)
    # 创建输出文件夹
    output_folder = folder / "已调整"
    output_folder.mkdir(exist_ok=True)
    
    for img_path in folder.glob("*.jpg"):
        # 打开图片
        with Image.open(img_path) as img:
            # 计算新尺寸，保持比例
            ratio = max_size / max(img.size)
            if ratio < 1:  # 只缩小，不放大
                new_size = tuple(int(x * ratio) for x in img.size)
                # 调整大小并保存
                img_resized = img.resize(new_size, Image.Resampling.LANCZOS)
                save_path = output_folder / img_path.name
                img_resized.save(save_path, quality=95)
                print(f"已处理: {img_path.name}")

# 使用示例
resize_images("度假照片")
```

## 图片压缩

### 批量压缩图片

```python
from PIL import Image
from pathlib import Path

def compress_images(folder_path, quality=80):
    folder = Path(folder_path)
    # 创建压缩后的文件夹
    compressed_folder = folder / "已压缩"
    compressed_folder.mkdir(exist_ok=True)
    
    for img_path in folder.glob("*.jpg"):
        # 打开并压缩
        with Image.open(img_path) as img:
            save_path = compressed_folder / img_path.name
            # 压缩保存
            img.save(save_path, "JPEG", quality=quality, optimize=True)
            
            # 显示压缩效果
            original_size = img_path.stat().st_size / 1024  # KB
            compressed_size = save_path.stat().st_size / 1024  # KB
            ratio = (1 - compressed_size/original_size) * 100
            print(f"{img_path.name}: {original_size:.1f}KB -> {compressed_size:.1f}KB "
                  f"(节省{ratio:.1f}%)")

# 使用示例
compress_images("手机相册")
```

## 照片整理工具

### 按拍摄时间自动分类

```python
from PIL import Image
from pathlib import Path
from datetime import datetime

def organize_photos(folder_path):
    folder = Path(folder_path)
    
    # 遍历所有图片
    for img_path in folder.glob("*.jpg"):
        try:
            # 获取照片拍摄时间
            with Image.open(img_path) as img:
                if hasattr(img, '_getexif') and img._getexif():
                    exif = img._getexif()
                    if 36867 in exif:  # 拍摄时间的EXIF标签
                        date_str = exif[36867]
                        date_obj = datetime.strptime(date_str, '%Y:%m:%d %H:%M:%S')
                        # 按年月建文件夹
                        year_month = date_obj.strftime('%Y-%m')
                        new_folder = folder / year_month
                        new_folder.mkdir(exist_ok=True)
                        # 移动文件
                        img_path.rename(new_folder / img_path.name)
                        print(f"已移动 {img_path.name} 到 {year_month}")
                    
        except Exception as e:
            print(f"处理 {img_path.name} 时出错: {e}")

# 使用示例
organize_photos("所有照片")
```

## 综合处理工具

### 一键处理所有操作

```python
def photo_processor(folder_path):
    print("🚀 开始处理图片...")
    
    # 先整理分类
    print("\n📂 正在整理照片...")
    organize_photos(folder_path)
    
    # 统一调整大小
    print("\n📐 正在调整尺寸...")
    resize_images(folder_path)
    
    # 最后压缩
    print("\n🗜️ 正在压缩图片...")
    compress_images(folder_path)
    
    print("\n✨ 所有操作已完成！")

# 一键启动
photo_processor("我的相册")
```

## 使用注意事项

1. 处理之前最好先备份，避免意外情况
2. 压缩质量建议设在 75-85 之间，再低图片就糊了
3. 批量处理时注意内存占用，文件太多建议分批处理
4. 建议将这些代码保存成脚本，需要时随时调用