server:
  port: 9527

spring:
  application:
    name: cloud-gateway # â­ å¾®æœåŠ¡åç§° - ç”¨äºæ³¨å†Œåˆ°æœåŠ¡å‘ç°ç³»ç»Ÿ(consul/nacos)
  cloud:
    consul: # ===== Consulé…ç½®åŒº =====
      host: localhost
      port: 8500
      discovery: # â­ æœåŠ¡å‘ç°é…ç½® - æ§åˆ¶æœåŠ¡å¦‚ä½•æ³¨å†Œåˆ°Consul
        prefer-ip-address: true # ä¼˜å…ˆä½¿ç”¨IPåœ°å€è€Œéä¸»æœºå
        service-name: ${spring.application.name}
    gateway: # ===== ç½‘å…³æ ¸å¿ƒé…ç½®åŒº =====
      routes: # â­ è·¯ç”±é…ç½®åˆ—è¡¨ - å®šä¹‰è¯·æ±‚å¦‚ä½•è½¬å‘åˆ°å„ä¸ªå¾®æœåŠ¡
        # ğŸ’¡ è·¯ç”±1é…ç½® - æ”¯ä»˜æœåŠ¡è·¯ç”±é…ç½®1
        - id: pay_routh1 # â­ è·¯ç”±å”¯ä¸€æ ‡è¯†ç¬¦ã€Œç±»ä¼¼æ•°æ®åº“ä¸»é”®ã€
#          uri: http://localhost:8001                # ç›´è¿æ–¹å¼(å·²æ³¨é‡Š)
          uri: lb://cloud-payment-service            # â­ è´Ÿè½½å‡è¡¡æ–¹å¼ã€Œlb://æœåŠ¡åã€- é€šè¿‡æœåŠ¡å‘ç°åŠ¨æ€è·¯ç”±
          predicates: # â­ æ–­è¨€é…ç½® - å†³å®šè¯·æ±‚æ˜¯å¦åŒ¹é…è¯¥è·¯ç”±
            - Path=/pay/gateway/get/**               # â­ è·¯å¾„åŒ¹é…æ–­è¨€ - åŒ¹é…æŒ‡å®šURLè·¯å¾„æ ¼å¼
            - After=2023-12-30T23:02:39.079979400+08:00[Asia/Shanghai] # â­ æ—¶é—´æ–­è¨€ - ä»…åœ¨æŒ‡å®šæ—¶é—´åç”Ÿæ•ˆ
            #- Cookie=username,zzyy                  # â­ Cookieæ–­è¨€ - è¦æ±‚Cookieä¸­åŒ…å«æŒ‡å®šé”®å€¼å¯¹
            #- Header=X-Request-Id, \d+              # â­ è¯·æ±‚å¤´æ–­è¨€ - è¦æ±‚Headeræ»¡è¶³æ­£åˆ™è¡¨è¾¾å¼
            #- Host=**.atguigu.com                   # â­ ä¸»æœºåæ–­è¨€ - é™åˆ¶è®¿é—®åŸŸå
            #- Query=username, \d+                   # â­ æŸ¥è¯¢å‚æ•°æ–­è¨€ - è¦æ±‚å‚æ•°æ»¡è¶³æ­£åˆ™è¡¨è¾¾å¼
            #- RemoteAddr=192.168.124.1/24           # â­ IPåœ°å€æ–­è¨€ - é™åˆ¶å®¢æˆ·ç«¯IPèŒƒå›´ã€ŒCIDRæ ¼å¼ã€
            #- My=gold                               # â­ è‡ªå®šä¹‰æ–­è¨€ç¤ºä¾‹ã€Œç®€å•æ–¹å¼ï¼Œä½†ç¼ºå°‘å®ç°ã€
#            - name: My # â­ è‡ªå®šä¹‰æ–­è¨€ã€Œå®Œæ•´æ–¹å¼ã€- éœ€è¦å¯¹åº”çš„æ–­è¨€å·¥å‚å®ç°
#              args:
#                userType: diamond

        # ğŸ’¡ è·¯ç”±2é…ç½® - æ”¯ä»˜æœåŠ¡è·¯ç”±é…ç½®2
        - id: pay_routh2
          #uri: http://localhost:8001                # ç›´è¿æ–¹å¼(å·²æ³¨é‡Š)
          uri: lb://cloud-payment-service            # â­ è´Ÿè½½å‡è¡¡æ–¹å¼ - é€šè¿‡æœåŠ¡ååŠ¨æ€å‘ç°æœåŠ¡å®ä¾‹
          predicates:
            - Path=/pay/gateway/info/**              # â­ è·¯å¾„åŒ¹é…æ–­è¨€ - åŒ¹é…infoæ¥å£è·¯å¾„

        # ğŸ’¡ è·¯ç”±3é…ç½® - æ”¯ä»˜æœåŠ¡è·¯ç”±é…ç½®3(å¸¦è¿‡æ»¤å™¨ç¤ºä¾‹)
        - id: pay_routh3
          uri: lb://cloud-payment-service
          predicates: 
            - Path=/pay/gateway/filter/**            # â­ å½“å‰ä½¿ç”¨çš„è·¯å¾„åŒ¹é…è§„åˆ™ - åŒ¹é…filteræ¥å£è·¯å¾„
            #- Path=/gateway/filter/**               # â­ é…åˆPrefixPathè¿‡æ»¤å™¨çš„æµ‹è¯•è·¯å¾„(å·²æ³¨é‡Š)
            #- Path=/XYZ/abc/{segment}               # â­ é…åˆSetPathè¿‡æ»¤å™¨çš„æµ‹è¯•è·¯å¾„(å·²æ³¨é‡Š)
          filters: # ===== è¿‡æ»¤å™¨é…ç½® ===== 
            # â— æ³¨æ„ï¼šè¯·æ±‚å…ˆç»è¿‡æ–­è¨€(predicates)åŒ¹é…ï¼Œå†ç»è¿‡è¿‡æ»¤å™¨(filters)å¤„ç†
            - My=atguigu                             # â­ è‡ªå®šä¹‰è¿‡æ»¤å™¨ç¤ºä¾‹ - éœ€è¦å¯¹åº”çš„è¿‡æ»¤å™¨å·¥å‚å®ç°
            
            # ----- é‡å®šå‘è¿‡æ»¤å™¨(å·²æ³¨é‡Š) -----
            #- RedirectTo=302, http://www.atguigu.com/ # â­ é‡å®šå‘è¿‡æ»¤å™¨ - å°†è¯·æ±‚é‡å®šå‘åˆ°å¤–éƒ¨URL
            
            # ----- è·¯å¾„æ“ä½œè¿‡æ»¤å™¨(å·²æ³¨é‡Š) -----
            #- SetPath=/pay/gateway/{segment}        # â­ è·¯å¾„é‡å†™è¿‡æ»¤å™¨ - ä½¿ç”¨å ä½ç¬¦åŠ¨æ€æ›¿æ¢è·¯å¾„
            #- PrefixPath=/pay                       # â­ å‰ç¼€æ·»åŠ è¿‡æ»¤å™¨ - å…è®¸å®¢æˆ·ç«¯ä½¿ç”¨ç®€åŒ–è·¯å¾„
            
            # ----- è¯·æ±‚å¤´æ“ä½œè¿‡æ»¤å™¨ -----
            - AddRequestHeader=X-Request-atguigu1,atguiguValue1  # â­ æ·»åŠ è¯·æ±‚å¤´è¿‡æ»¤å™¨ - å¢åŠ è‡ªå®šä¹‰è¯·æ±‚å¤´
            #- AddRequestHeader=X-Request-atguigu2,atguiguValue2  # â­ å¤šä¸ªè¯·æ±‚å¤´éœ€åˆ†è¡Œè®¾ç½®
            #- RemoveRequestHeader=sec-fetch-site    # â­ åˆ é™¤è¯·æ±‚å¤´è¿‡æ»¤å™¨ - ç§»é™¤æŒ‡å®šè¯·æ±‚å¤´
            #- SetRequestHeader=sec-fetch-mode, Blue-updatebyzzyy # â­ ä¿®æ”¹è¯·æ±‚å¤´è¿‡æ»¤å™¨ - è¦†ç›–å·²æœ‰è¯·æ±‚å¤´
            
            # ----- è¯·æ±‚å‚æ•°æ“ä½œè¿‡æ»¤å™¨(å·²æ³¨é‡Š) -----
            #- AddRequestParameter=customerId,9527001 # â­ æ·»åŠ è¯·æ±‚å‚æ•°è¿‡æ»¤å™¨ - å·²æœ‰åˆ™ä¸è¦†ç›–
            #- RemoveRequestParameter=customerName   # â­ åˆ é™¤è¯·æ±‚å‚æ•°è¿‡æ»¤å™¨ - ç§»é™¤æŒ‡å®šå‚æ•°
            
            # ----- å“åº”å¤´æ“ä½œè¿‡æ»¤å™¨(å·²æ³¨é‡Š) -----
            #- AddResponseHeader=X-Response-atguigu, BlueResponse # â­ æ·»åŠ å“åº”å¤´è¿‡æ»¤å™¨ - å¢åŠ è‡ªå®šä¹‰å“åº”å¤´
            #- SetResponseHeader=Date,2099-11-11     # â­ è®¾ç½®å“åº”å¤´è¿‡æ»¤å™¨ - è¦†ç›–å·²æœ‰å“åº”å¤´
            #- RemoveResponseHeader=Content-Type     # â­ åˆ é™¤å“åº”å¤´è¿‡æ»¤å™¨ - ç§»é™¤æŒ‡å®šå“åº”å¤´